

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using Meshmagick &mdash; Meshmagick User&#39;s Guide 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Meshmagick User&#39;s Guide 1.0 documentation" href="../index.html"/>
        <link rel="up" title="Meshmagick’s Command Line Interface" href="index.html"/>
        <link rel="next" title="Command Line Interface Reference Guide" href="cli_reference.html"/>
        <link rel="prev" title="Meshmagick’s Command Line Interface" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Meshmagick User's Guide
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Installation Instructions</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Meshmagick&#8217;s Command Line Interface</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Using Meshmagick</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#getting-help">Getting help</a></li>
<li class="toctree-l3"><a class="reference internal" href="#converting-a-mesh-file">Converting a mesh file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quiet-mode">Quiet mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getting-information-on-a-mesh">Getting information on a mesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#quick-information">Quick information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mesh-quality-metrics">Mesh quality metrics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mesh-file-visualization">Mesh file visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mesh-healing">Mesh healing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#removing-duplicate-vertices">Removing duplicate vertices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#healing-normals">Healing normals</a></li>
<li class="toctree-l4"><a class="reference internal" href="#flipping-normals">Flipping normals</a></li>
<li class="toctree-l4"><a class="reference internal" href="#global-healing">Global healing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mesh-transformations">Mesh transformations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#translations">Translations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rotations">Rotations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scaling">Scaling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#triangulating-quadrangles">Triangulating quadrangles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#working-with-planes">Working with planes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#defining-planes">Defining planes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clipping-a-mesh-by-a-plane">Clipping a mesh by a plane</a></li>
<li class="toctree-l4"><a class="reference internal" href="#symmetrizing-a-mesh-about-a-plane">Symmetrizing a mesh about a plane</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#getting-inertial-properties-of-the-mesh">Getting inertial properties of the mesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#defining-the-medium-density">Defining the medium density</a></li>
<li class="toctree-l4"><a class="reference internal" href="#guessing-the-mesh-is-filled-with-homogeneous-medium">Guessing the mesh is filled with homogeneous medium</a></li>
<li class="toctree-l4"><a class="reference internal" href="#guessing-the-mesh-is-a-shell">Guessing the mesh is a shell</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#performing-hydrostatics-calculations-on-the-mesh">Performing hydrostatics calculations on the mesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#expression-of-the-hydrostatic-data">Expression of the hydrostatic data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#getting-hydrostatics-properties-of-the-mesh">Getting hydrostatics properties of the mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="#displaying-the-mesh-with-hydrostatic-results">Displaying the mesh with hydrostatic results</a></li>
<li class="toctree-l4"><a class="reference internal" href="#getting-the-mesh-vertical-position-that-complies-with-a-given-mass-displacement">Getting the mesh vertical position that complies with a given mass displacement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#d-hydrostatic-equilibrium">3D hydrostatic equilibrium</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adding-external-static-forces">Adding external static forces</a></li>
<li class="toctree-l4"><a class="reference internal" href="#saving-the-hydrostatic-report-in-a-text-file">Saving the hydrostatic report in a text file</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cli_reference.html">CLI reference</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Meshmagick Package&#8217;s modules</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Meshmagick User's Guide</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Meshmagick&#8217;s Command Line Interface</a> &raquo;</li>
      
    <li>Using Meshmagick</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/command_line/cli_usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-meshmagick">
<h1>Using Meshmagick<a class="headerlink" href="#using-meshmagick" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Mesh files examples used through this page are available under the <cite>meshmagick/tests/data</cite> directory so that you
can play with them.</li>
<li>Images that illustrate the examples have been obtained with the Meshmagick&#8217;s viewer and by pressing the <code class="docutils literal"><span class="pre">c</span></code>
keystroke.</li>
<li>Most of the command line options may be combined.</li>
</ul>
</div>
<div class="contents local topic" id="content">
<p class="topic-title first">Content</p>
<ul class="simple">
<li><a class="reference internal" href="#getting-help" id="id1">Getting help</a></li>
<li><a class="reference internal" href="#converting-a-mesh-file" id="id2">Converting a mesh file</a></li>
<li><a class="reference internal" href="#quiet-mode" id="id3">Quiet mode</a></li>
<li><a class="reference internal" href="#getting-information-on-a-mesh" id="id4">Getting information on a mesh</a><ul>
<li><a class="reference internal" href="#quick-information" id="id5">Quick information</a></li>
<li><a class="reference internal" href="#mesh-quality-metrics" id="id6">Mesh quality metrics</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mesh-file-visualization" id="id7">Mesh file visualization</a></li>
<li><a class="reference internal" href="#mesh-healing" id="id8">Mesh healing</a><ul>
<li><a class="reference internal" href="#removing-duplicate-vertices" id="id9">Removing duplicate vertices</a></li>
<li><a class="reference internal" href="#healing-normals" id="id10">Healing normals</a></li>
<li><a class="reference internal" href="#flipping-normals" id="id11">Flipping normals</a></li>
<li><a class="reference internal" href="#global-healing" id="id12">Global healing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mesh-transformations" id="id13">Mesh transformations</a><ul>
<li><a class="reference internal" href="#translations" id="id14">Translations</a></li>
<li><a class="reference internal" href="#rotations" id="id15">Rotations</a></li>
<li><a class="reference internal" href="#scaling" id="id16">Scaling</a></li>
</ul>
</li>
<li><a class="reference internal" href="#triangulating-quadrangles" id="id17">Triangulating quadrangles</a></li>
<li><a class="reference internal" href="#working-with-planes" id="id18">Working with planes</a><ul>
<li><a class="reference internal" href="#defining-planes" id="id19">Defining planes</a></li>
<li><a class="reference internal" href="#clipping-a-mesh-by-a-plane" id="id20">Clipping a mesh by a plane</a></li>
<li><a class="reference internal" href="#symmetrizing-a-mesh-about-a-plane" id="id21">Symmetrizing a mesh about a plane</a></li>
</ul>
</li>
<li><a class="reference internal" href="#getting-inertial-properties-of-the-mesh" id="id22">Getting inertial properties of the mesh</a><ul>
<li><a class="reference internal" href="#defining-the-medium-density" id="id23">Defining the medium density</a></li>
<li><a class="reference internal" href="#guessing-the-mesh-is-filled-with-homogeneous-medium" id="id24">Guessing the mesh is filled with homogeneous medium</a></li>
<li><a class="reference internal" href="#guessing-the-mesh-is-a-shell" id="id25">Guessing the mesh is a shell</a></li>
</ul>
</li>
<li><a class="reference internal" href="#performing-hydrostatics-calculations-on-the-mesh" id="id26">Performing hydrostatics calculations on the mesh</a><ul>
<li><a class="reference internal" href="#expression-of-the-hydrostatic-data" id="id27">Expression of the hydrostatic data</a></li>
<li><a class="reference internal" href="#getting-hydrostatics-properties-of-the-mesh" id="id28">Getting hydrostatics properties of the mesh</a></li>
<li><a class="reference internal" href="#displaying-the-mesh-with-hydrostatic-results" id="id29">Displaying the mesh with hydrostatic results</a></li>
<li><a class="reference internal" href="#getting-the-mesh-vertical-position-that-complies-with-a-given-mass-displacement" id="id30">Getting the mesh vertical position that complies with a given mass displacement</a></li>
<li><a class="reference internal" href="#d-hydrostatic-equilibrium" id="id31">3D hydrostatic equilibrium</a></li>
<li><a class="reference internal" href="#adding-external-static-forces" id="id32">Adding external static forces</a><ul>
<li><a class="reference internal" href="#absolute-forces" id="id33">Absolute forces</a></li>
<li><a class="reference internal" href="#relative-forces" id="id34">Relative forces</a></li>
</ul>
</li>
<li><a class="reference internal" href="#saving-the-hydrostatic-report-in-a-text-file" id="id35">Saving the hydrostatic report in a text file</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="getting-help">
<h2><a class="toc-backref" href="#content">Getting help</a><a class="headerlink" href="#getting-help" title="Permalink to this headline">¶</a></h2>
<p>You can get command line help by issuing the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick -h
</pre></div>
</div>
<p>The output of this command is reproduced in the <a class="reference internal" href="cli_reference.html"><span class="doc">Command Line Interface Reference Guide</span></a>.</p>
</div>
<div class="section" id="converting-a-mesh-file">
<h2><a class="toc-backref" href="#content">Converting a mesh file</a><a class="headerlink" href="#converting-a-mesh-file" title="Permalink to this headline">¶</a></h2>
<p>Converting a mesh file is one of the most basic usage of Meshmagick:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -o SEAREV.mar
</pre></div>
</div>
<p>The format of the file is generally guessed from the extensions. Sometimes the extension may not be explicit
enough to guess the file format. You should then use the <code class="docutils literal"><span class="pre">-ifmt</span> <span class="pre">(--input-format)</span></code> and
<code class="docutils literal"><span class="pre">-ofmt</span> <span class="pre">(--output-format)</span></code> options to explicitly declare the file format:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -ifmt paraview SEAREV.vtp -ofmt nemoh SEAREV.dat
</pre></div>
</div>
<p>This way, we told Meshmagick that SEAREV.dat must be in the
<a class="reference external" href="https://lheea.ec-nantes.fr/doku.php/emo/nemoh/start">Nemoh</a> input mesh file format.</p>
</div>
<div class="section" id="quiet-mode">
<h2><a class="toc-backref" href="#content">Quiet mode</a><a class="headerlink" href="#quiet-mode" title="Permalink to this headline">¶</a></h2>
<p>To switch off outputs of Meshmagick, use the <code class="docutils literal"><span class="pre">-q</span> <span class="pre">(--quiet)</span></code> option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -q
</pre></div>
</div>
</div>
<div class="section" id="getting-information-on-a-mesh">
<h2><a class="toc-backref" href="#content">Getting information on a mesh</a><a class="headerlink" href="#getting-information-on-a-mesh" title="Permalink to this headline">¶</a></h2>
<div class="section" id="quick-information">
<h3><a class="toc-backref" href="#content">Quick information</a><a class="headerlink" href="#quick-information" title="Permalink to this headline">¶</a></h3>
<p>Quick information on a mesh is given by the <code class="docutils literal"><span class="pre">-i</span> <span class="pre">(--info)</span></code> option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -i
</pre></div>
</div>
<p>That gives us the following output:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/SEAREV.vtp successfully loaded

        --------------------------------------------
        	MESH NAME : SEAREV
        --------------------------------------------

        Number of vertices: 14354
        Number of faces:    15804

        Number of triangles:   2904
        Number of quadrangles: 12900

        xmin = -4.999371	xmax = 4.998167
        ymin = -15.000000	ymax = 15.000000
        zmin = -5.000000	zmax = 6.000000


        

=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
</div>
<div class="section" id="mesh-quality-metrics">
<h3><a class="toc-backref" href="#content">Mesh quality metrics</a><a class="headerlink" href="#mesh-quality-metrics" title="Permalink to this headline">¶</a></h3>
<p>You can get some quality metrics on the mesh by issuing:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp --quality
</pre></div>
</div>
<p>that gives:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/SEAREV.vtp successfully loaded

Triangle quality of the mesh (2904 elements):

 Area Ratio:
    range: 0.0315238  -  0.104016
    average: 0.060761  , standard deviation: 0.0129906
 Edge Ratio:
    range: 1.0115  -  1.68482
    average: 1.28402  , standard deviation: 0.135239
 Aspect Ratio:
    range: 1.00504  -  1.78696
    average: 1.17559  , standard deviation: 0.104713
 Radius Ratio:
    range: 1.0001  -  1.63074
    average: 1.06858  , standard deviation: 0.0637777
 Frobenius Norm:
    range: 1.00009  -  1.4086
    average: 1.0574  , standard deviation: 0.0487658
 Minimal Angle:
    range: 35.6524  -  59.4647
    average: 48.5477  , standard deviation: 4.93326

Quadrilateral quality of the mesh (12900 elements):

 Area Ratio:
    range: 0.0774506  -  0.0812261
    average: 0.0797408  , standard deviation: 0.00129459
 Edge Ratio:
    range: 1.93626  -  2.03065
    average: 1.99352  , standard deviation: 0.0323648
 Aspect Ratio:
    range: 1.46813  -  1.51532
    average: 1.49676  , standard deviation: 0.0161824
 Radius Ratio:
    range: 1.22636  -  1.26155
    average: 1.24764  , standard deviation: 0.0120902
 Average Frobenius Norm:
    range: 1.22636  -  1.26155
    average: 1.24764  , standard deviation: 0.0120902
 Maximal Frobenius Norm:
    range: 1.22636  -  1.26155
    average: 1.24764  , standard deviation: 0.0120902
 Minimal Angle:
    range: 90  -  90
    average: 90  , standard deviation: 0


Definition of the different quality measures is given
        in the verdict library manual :
        http://www.vtk.org/Wiki/images/6/6b/VerdictManual-revA.pdf


=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This option requires that you have installed a version of the python VTK library as it is used to compute these
metrics. It relies on the <strong>verdict</strong> library, initially developed at Sandia lab and later included into VTK. More
information on the metrics can be seen in the
<a class="reference external" href="http://www.vtk.org/Wiki/images/6/6b/VerdictManual-revA.pdf">Verdict manual</a>.</p>
</div>
</div>
</div>
<div class="section" id="mesh-file-visualization">
<h2><a class="toc-backref" href="#content">Mesh file visualization</a><a class="headerlink" href="#mesh-file-visualization" title="Permalink to this headline">¶</a></h2>
<p>Quickly viewing a mesh can be achieved by using the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp --show
</pre></div>
</div>
<p>that opens the internal Meshmagick&#8217;s viewer.</p>
<img alt="../_images/viewer.png" src="../_images/viewer.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The viewer relies on VTK, so the python VTK library must be installed in order to use it.</p>
</div>
<p>The viewer is blazing fast and support mesh manipulation with the mouse. Some keyboard keys are available and their
usage is indicated in the upper right panel.</p>
<p>Certainly the most useful feature is the visualization of normals by pressing the <code class="docutils literal"><span class="pre">n</span></code> keystroke so that you can verify
consistency of normals across the mesh as well as orientation (must generally be outward for computations).</p>
<img alt="../_images/viewer_options.png" src="../_images/viewer_options.png" />
<p>The above screenshot has been obtained by pressing successively the keys <code class="docutils literal"><span class="pre">n</span></code> (showing normals), <code class="docutils literal"><span class="pre">w</span></code> (wire
representation), <code class="docutils literal"><span class="pre">h</span></code> (show Oxy plane i.e. the water free surface) and <code class="docutils literal"><span class="pre">c</span></code> (to save a screenshot that is saved
under the name <code class="docutils literal"><span class="pre">screenshot.png</span></code> in the current working directory.)</p>
<p><strong>Just play with options to discover what is available !</strong></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The frame at the lower left corner is draggable and resizable so that you can inspect your mesh for alignment or
whatever you want.</p>
</div>
</div>
<div class="section" id="mesh-healing">
<h2><a class="toc-backref" href="#content">Mesh healing</a><a class="headerlink" href="#mesh-healing" title="Permalink to this headline">¶</a></h2>
<p>Meshmagick offers some options to deal with mesh description. Sometimes, meshes are produced with duplicated vertices
description, making it impossible to establish some advanced connectivities. This is intrinsically the case for e.g. in
GDF files, the input mesh file format of <a class="reference external" href="http://www.wamit.com/">Wamit</a> where faces are internally represented by
vertices coordinates only, without using a connectivity table.</p>
<p>Sometimes also, faces normals are not consistent. This is often the case by e.g. when using <a class="reference external" href="http://gmsh.info/">GMSH</a>
mesh generator. You may also want to flip every normals.</p>
<div class="section" id="removing-duplicate-vertices">
<h3><a class="toc-backref" href="#content">Removing duplicate vertices</a><a class="headerlink" href="#removing-duplicate-vertices" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">-md</span> <span class="pre">(--merge-duplicates)</span></code> option does this:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick coque.gdf -md
</pre></div>
</div>
<p>that gives:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/coque.gdf successfully loaded
* Merging duplicate vertices that lie in an absolute proximity of 1.0E-08...
	--&gt; Initial number of vertices : 15100
	--&gt; Final number of vertices   : 3911
	--&gt; 11189 vertices have been merged


=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
<p>This allows to generate connectivity tables in the mesh and may drastically reduce the mesh size in memory and on disk.</p>
</div>
<div class="section" id="healing-normals">
<h3><a class="toc-backref" href="#content">Healing normals</a><a class="headerlink" href="#healing-normals" title="Permalink to this headline">¶</a></h3>
<p>This is obtained by using the <code class="docutils literal"><span class="pre">-hn</span> <span class="pre">(--heal-normals)</span></code> command line option. Let&#8217;s have an example. In the
<cite>meshmagick/tests/data</cite> folder, you can find the file <code class="docutils literal"><span class="pre">cylinder.geo</span></code> that is a geometry file using the <em>GMSH</em>
language for modeling geometry. It models the eighth of a cylinder.</p>
<p>If you have <em>GMSH</em> on your computer, you can generate a mesh file from this file by issuing the
following command in your terminal:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ gmsh -2 cylinder.geo
</pre></div>
</div>
<p>It will generate a file named <code class="docutils literal"><span class="pre">cylinder.msh</span></code> which is a surface mesh of the portion of cylinder. One thing that you
can do is to visualize this mesh with the <code class="docutils literal"><span class="pre">--show</span></code> option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick cylinder.msh --show
</pre></div>
</div>
<p>and stroke <code class="docutils literal"><span class="pre">n</span></code> to watch normals.</p>
<img alt="../_images/cylinder_msh_normals.png" src="../_images/cylinder_msh_normals.png" />
<p>It is clear that <em>GMSH</em> did not orient the normals consistently. Now, you can heal them by issuing by e.g.:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick cylinder.msh -hn -o cylinder_healed.vtp --show
</pre></div>
</div>
<p>which heals the normals, opens the Meshmagick&#8217;s viewer and writes the healed mesh as a <em>vtp</em> file that can be opened
into <em>Paraview</em>.</p>
<img alt="../_images/cylinder_msh_normals_healed.png" src="../_images/cylinder_msh_normals_healed.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This option uses a <a class="reference external" href="https://en.wikipedia.org/wiki/Flood_fill">flood fill algorithm</a> to diffuse the normal
orientation information. For doing so, it requires to establish a connectivity map for faces/faces adjacency. For
this map to be realized, it is necessary to merge duplicate nodes before healing normals. When invoking the
<code class="docutils literal"><span class="pre">-md</span> <span class="pre">(--merge-duplicates)</span></code> and <code class="docutils literal"><span class="pre">-hn</span> <span class="pre">(--heal-normals)</span></code> options at the same time, merging is done
before healing so it is verified.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If your mesh is not conformal, this option <strong>may</strong> fail as the connectivity map used by the flooding algorithm
<strong>may</strong> present some non connected patches of faces that will be flooded independently, making the transit of
normal orientation between these patch impossible.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the mesh is closed and conformal, a side effect of this option is to test if the normals are outgoing and
correct them if they are not. This is achieved by &#8220;plunging the mesh in water&#8221; and integrate the hydrostatics
pressure to identify the resultant force orientation which must be along the positive vertical in case the
normals are outgoing. If the mesh does not allow this checking, normals are nevertheless made consistent and you are
warned about the eventual need to manually watch the normals from the Meshmagick&#8217;s viewer and issue a new command
to flip the whole normals as described in the following.</p>
</div>
</div>
<div class="section" id="flipping-normals">
<h3><a class="toc-backref" href="#content">Flipping normals</a><a class="headerlink" href="#flipping-normals" title="Permalink to this headline">¶</a></h3>
<p>This can be done with the <code class="docutils literal"><span class="pre">-fn</span> <span class="pre">(--flip-normals)</span></code> option. Based on the <code class="docutils literal"><span class="pre">cylinder.vtp</span></code> file obtained just
before, if we issue the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick cylinder.vtp -fn --show
</pre></div>
</div>
<p>we get:</p>
<img alt="../_images/cylinder_msh_normals_flipped.png" src="../_images/cylinder_msh_normals_flipped.png" />
</div>
<div class="section" id="global-healing">
<h3><a class="toc-backref" href="#content">Global healing</a><a class="headerlink" href="#global-healing" title="Permalink to this headline">¶</a></h3>
<p>When getting a mesh file from somewhere, you could use the <code class="docutils literal"><span class="pre">-hm</span> <span class="pre">(--heal-mesh)</span></code> option to automatically apply a
set of sanity checks and modifications on the mesh. It successively applies the following operations:</p>
<ul class="simple">
<li>Removes unused vertices</li>
<li>Removes degenerated faces</li>
<li>Merge duplicate vertices</li>
<li>Heal triangles description</li>
<li>Heal normal orientations</li>
</ul>
<p>The command is then:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick cylinder.msh -hm
</pre></div>
</div>
<p>that outputs:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/cylinder.msh successfully loaded

OPERATION: heal the mesh
* Removing unused vertices in the mesh:
	--&gt; 1 unused vertices have been removed
* Removing degenerated faces
	--&gt; No degenerated faces
* Merging duplicate vertices that lie in an absolute proximity of 1.0E-08...
	--&gt; No duplicate vertices have been found
* Ensuring consistent definition of triangles:
	--&gt; Triangle description is consistent
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
Boundary is not closed !!!
* Healing normals to make them consistent and if possible outward
	--&gt; 2000 faces have been reversed to make normals consistent across the mesh
	--&gt; WARNING: the mesh does not seem watertight althought marked as closed...
	Done.

=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
</div>
</div>
<div class="section" id="mesh-transformations">
<h2><a class="toc-backref" href="#content">Mesh transformations</a><a class="headerlink" href="#mesh-transformations" title="Permalink to this headline">¶</a></h2>
<p>Some basic mesh transformation options are available: translations, rotations, scaling.</p>
<div class="section" id="translations">
<h3><a class="toc-backref" href="#content">Translations</a><a class="headerlink" href="#translations" title="Permalink to this headline">¶</a></h3>
<p>The options to use are <code class="docutils literal"><span class="pre">-tx</span> <span class="pre">(--translatex)</span></code>, <code class="docutils literal"><span class="pre">-ty</span> <span class="pre">(--translatey)</span></code>, <code class="docutils literal"><span class="pre">-tz</span> <span class="pre">(--translatez)</span></code>,
<code class="docutils literal"><span class="pre">-t</span> <span class="pre">(--translate)</span></code> which respectively performs translations along the x axis, the y axis, the z axis and along a
coordinate vector. The invocations are:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -tx 10
&gt;$ meshmagick SEAREV.vtp -ty 10
&gt;$ meshmagick SEAREV.vtp -tz 10

&gt;$ meshmagick SEAREV.vtp -t <span class="m">10</span> <span class="m">10</span> <span class="m">10</span> -i
</pre></div>
</div>
<p>for translations of 10 along specific axes and along the coordinate vector (10, 10, 10). The last command gives:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/SEAREV.vtp successfully loaded

OPERATION: Translation by [10.000000, 10.000000, 10.000000]
	-&gt; Done.

        --------------------------------------------
        	MESH NAME : SEAREV
        --------------------------------------------

        Number of vertices: 14354
        Number of faces:    15804

        Number of triangles:   2904
        Number of quadrangles: 12900

        xmin = 5.000629	xmax = 14.998167
        ymin = -5.000000	ymax = 25.000000
        zmin = 5.000000	zmax = 16.000000


        

=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
</div>
<div class="section" id="rotations">
<h3><a class="toc-backref" href="#content">Rotations</a><a class="headerlink" href="#rotations" title="Permalink to this headline">¶</a></h3>
<p>The options to use are <code class="docutils literal"><span class="pre">-rx</span> <span class="pre">(--rotatex)</span></code>, <code class="docutils literal"><span class="pre">-ry</span> <span class="pre">(--rotatey)</span></code>, <code class="docutils literal"><span class="pre">-rz</span> <span class="pre">(--rotatez)</span></code>,
<code class="docutils literal"><span class="pre">-r</span> <span class="pre">(--rotate)</span></code> which respectively performs rotations around the x axis, the y axis, the z axis and a 3D
rotation along fixed axis rotation vector. The invocations are:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -rx 90
&gt;$ meshmagick SEAREV.vtp -ry 90
&gt;$ meshmagick SEAREV.vtp -rz 90

&gt;$ meshmagick SEAREV.vtp -r <span class="m">90</span> <span class="m">90</span> <span class="m">90</span> -i
</pre></div>
</div>
<p>for rotations of 90° around specific axes and around the rotation coordinate vector (90, 90, 90). The last command
gives:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/SEAREV.vtp successfully loaded

OPERATION: Rotation by [90.000000, 90.000000, 90.000000] (degrees)
	-&gt; Done.

        --------------------------------------------
        	MESH NAME : SEAREV
        --------------------------------------------

        Number of vertices: 14354
        Number of faces:    15804

        Number of triangles:   2904
        Number of quadrangles: 12900

        xmin = -10.603241	xmax = 12.371918
        ymin = -8.932214	ymax = 8.932176
        zmin = -16.367325	zmax = 15.536390


        

=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<ul class="last simple">
<li>When using the <code class="docutils literal"><span class="pre">-r</span> <span class="pre">(--rotate)</span></code> option, please keep in mind that the angles given are not the Cardan angles
(Roll, Pitch, Yaw) but angles around a fixed rotation axis.</li>
<li>Angles must be given in degrees.</li>
</ul>
</div>
</div>
<div class="section" id="scaling">
<h3><a class="toc-backref" href="#content">Scaling</a><a class="headerlink" href="#scaling" title="Permalink to this headline">¶</a></h3>
<p>The options to use are <code class="docutils literal"><span class="pre">-sx</span> <span class="pre">(--scalex)</span></code>, <code class="docutils literal"><span class="pre">-sy</span> <span class="pre">(--scaley)</span></code>, <code class="docutils literal"><span class="pre">-sz</span> <span class="pre">(--scalez)</span></code>,
<code class="docutils literal"><span class="pre">-s</span> <span class="pre">(--scale)</span></code> which respectively performs scaling along the x axis, the y axis, the z axis and a 3D
scaling of the mesh. The invocations are:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -sx 2
&gt;$ meshmagick SEAREV.vtp -sy 2
&gt;$ meshmagick SEAREV.vtp -sz 2

&gt;$ meshmagick SEAREV.vtp -s <span class="m">2</span> -i
</pre></div>
</div>
<p>for scaling of 2 along specific axes and of the whole mesh in space. The last command gives:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/SEAREV.vtp successfully loaded

OPERATION: Scaling by 2.000000
	-&gt; Done.

        --------------------------------------------
        	MESH NAME : SEAREV
        --------------------------------------------

        Number of vertices: 14354
        Number of faces:    15804

        Number of triangles:   2904
        Number of quadrangles: 12900

        xmin = -9.998741	xmax = 9.996333
        ymin = -30.000000	ymax = 30.000000
        zmin = -10.000000	zmax = 12.000000


        

=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Scaling is performed before any translations when both options are used. So the translation magnitudes must be
adapted to be consistent with the new scale of the mesh.</p>
</div>
</div>
</div>
<div class="section" id="triangulating-quadrangles">
<h2><a class="toc-backref" href="#content">Triangulating quadrangles</a><a class="headerlink" href="#triangulating-quadrangles" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">-tq</span> <span class="pre">(--triangulate-quadrangles)</span></code> allows to split every quadrangle faces in the mesh into two triangle:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick cylinder.msh -tq --show
</pre></div>
</div>
<p>that displays the following:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/cylinder.msh successfully loaded

Triangulating quadrangles
	--&gt;3000 quadrangles have been split in triangles

=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
<img alt="../_images/triangulate.png" src="../_images/triangulate.png" />
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The splitting procedure is basic and keep in mind that no check is done on the quality of the generated triangles.
If your mesh faces does not have a good aspect ratio, it could produce some really tiny triangles.</p>
</div>
</div>
<div class="section" id="working-with-planes">
<h2><a class="toc-backref" href="#content">Working with planes</a><a class="headerlink" href="#working-with-planes" title="Permalink to this headline">¶</a></h2>
<p>Planes may be used in different situation as seen below. They can be defined so as to perform mesh clipping (useful
to provide the submerged part of the mesh to hydrodynamics BEM software such as Nemoh), symmetrizing (when only a
part of the mesh has been generated as in the <code class="docutils literal"><span class="pre">cylinder.geo</span></code> gmsh geometry file example) or mirroring.</p>
<p>A plane is defined by its normal <span class="math">\(\vec{n}\)</span> and a scalar parameter <span class="math">\(c\)</span> following the equation
<span class="math">\(\vec{n}.\vec{x} = c\)</span>, where <span class="math">\(\vec{x}\)</span> is the coordinate vector of a point belonging to the plane.</p>
<p>The scalar parameter <span class="math">\(c\)</span> is practically the orthogonal distance between the origin of the reference frame and
the plane.</p>
<p>Working with planes is quite flexible as you have 3 mean to use them along with plane dependent options:</p>
<ul>
<li><p class="first">Defining the plane by 4 scalars:  <span class="math">\(n_x, n_y, n_z, c\)</span></p>
</li>
<li><dl class="first docutils">
<dt>Using predefined plane keywords:</dt>
<dd><ul class="first last simple">
<li>Oxy</li>
<li>Oxz</li>
<li>Oyz</li>
<li>/Oxy</li>
<li>/Oxz</li>
<li>/Oyz</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Using the index of a plane that has been defined with the <code class="docutils literal"><span class="pre">-p</span> <span class="pre">(--plane)</span></code> option.</p>
</li>
</ul>
<div class="section" id="defining-planes">
<h3><a class="toc-backref" href="#content">Defining planes</a><a class="headerlink" href="#defining-planes" title="Permalink to this headline">¶</a></h3>
<p>A plane may be defined at the command line level along with de <code class="docutils literal"><span class="pre">-p</span> <span class="pre">(--plane)</span></code> option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -p <span class="m">0</span> <span class="m">0</span> <span class="m">1</span> 0
</pre></div>
</div>
<p>defines the plane with normal (0, 0, 1) and the scalar parameter 0.</p>
<p>It is also possible to define the same plane by a predefined keyword argument:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -p Oxy
</pre></div>
</div>
<p>Predefined keywords arguments are Oxy, Oxz, Oyz, /Oxy, /Oxz, /Oyz and are self descriptive. The slash indicates that
the normals is reversed.</p>
<p>It is possible to define several planes at once such as in:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -p Oxy -p /Oxz
</pre></div>
</div>
<p>When defining planes with the <code class="docutils literal"><span class="pre">-p</span> <span class="pre">(--plane)</span></code> option, the planes definitions are internally stored in a list in
the order that you used in the command line and it is then possible to refer to them in other options by their index in
the list, starting by 0. So in the above command line, the plane Oxy can be refereed as the plane index 0 and the /Oxz
plane as the plane index 1.</p>
</div>
<div class="section" id="clipping-a-mesh-by-a-plane">
<h3><a class="toc-backref" href="#content">Clipping a mesh by a plane</a><a class="headerlink" href="#clipping-a-mesh-by-a-plane" title="Permalink to this headline">¶</a></h3>
<p>To clip a mesh against a plane, use the <code class="docutils literal"><span class="pre">-c</span> <span class="pre">(--clip)</span></code> option like in:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -c <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="m">2</span> --show
</pre></div>
</div>
<p>that displays the following view:</p>
<img alt="../_images/clip.png" src="../_images/clip.png" />
<p>As said before, the above command is strictly equivalent to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -p <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="m">2</span> -c <span class="m">0</span> --show
</pre></div>
</div>
<p>It is also possible to use several <code class="docutils literal"><span class="pre">-c</span> <span class="pre">(--clip)</span></code> option at a time:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -c Oxy -c Oyz --show
</pre></div>
</div>
<p>that gives:</p>
<img alt="../_images/clip2.png" src="../_images/clip2.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is possible to invoke the <code class="docutils literal"><span class="pre">-c</span> <span class="pre">(--clip)</span></code> option without any argument. In that case, a default Oxy plane
is taken.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The part of the mesh that is kept is that opposite to the plane&#8217;s normal orientation.</p>
</div>
</div>
<div class="section" id="symmetrizing-a-mesh-about-a-plane">
<h3><a class="toc-backref" href="#content">Symmetrizing a mesh about a plane</a><a class="headerlink" href="#symmetrizing-a-mesh-about-a-plane" title="Permalink to this headline">¶</a></h3>
<p>To symmetrize a mesh about a plane, use the <code class="docutils literal"><span class="pre">--sym</span> <span class="pre">(--symmetrize)</span></code> option. Taking back the <code class="docutils literal"><span class="pre">cylinder.msh</span></code>
example generated sooner, we can issue:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick cylinder.msh --sym Oxy --show
</pre></div>
</div>
<p>that gives:</p>
<img alt="../_images/cylinder_sym.png" src="../_images/cylinder_sym.png" />
<p>Combining the options allow us to close the cylinder:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick cylinder.msh --sym Oxy --sym Oxz --sym Oyz --show
</pre></div>
</div>
<p>that gives:</p>
<img alt="../_images/cylinder_sym3.png" src="../_images/cylinder_sym3.png" />
<p>Checking normals gives as expected:</p>
<img alt="../_images/cylinder_sym3_normals.png" src="../_images/cylinder_sym3_normals.png" />
<p>that we can heal:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick cylinder.msh --sym Oxy --sym Oxz --sym Oyz -hn --show
</pre></div>
</div>
<img alt="../_images/cylinder_sym3_normals_healed.png" src="../_images/cylinder_sym3_normals_healed.png" />
<p>and clip back:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick cylinder.msh --sym Oxy --sym Oxz --sym Oyz -hn -c Oxy -c Oyz -c Oxz --show
</pre></div>
</div>
<p>making us confident with respect to the normal consistency and orientation (outward) of our open part of cylinder mesh:</p>
<img alt="../_images/cylinder_sym3_normals_healed_clip.png" src="../_images/cylinder_sym3_normals_healed_clip.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Faces quality on the vicinity of the clipping plane is not checked. You can then generate faces with very poor
aspect ratio. This will be fixed in a future Meshmagick&#8217;s release by applying a projection procedure that is
nontrivial to develop as it must not modify the geometry locally.</p>
</div>
</div>
</div>
<div class="section" id="getting-inertial-properties-of-the-mesh">
<h2><a class="toc-backref" href="#content">Getting inertial properties of the mesh</a><a class="headerlink" href="#getting-inertial-properties-of-the-mesh" title="Permalink to this headline">¶</a></h2>
<p>Meshmagick allows to calculate inertial properties of meshes based on some assumptions on the mass distribution:</p>
<ul class="simple">
<li>A mesh which is <strong>uniformly filled</strong> with an homogeneous medium with a given density (the practical interest if for
e.g. for ballast modeling).</li>
<li>A mesh considered as a <strong>shell</strong> having a constant thickness and made in a medium of a given density (approximation
for floating structures).</li>
</ul>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Add  keywords for available medium...</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<ul class="last">
<li><p class="first"><strong>Inertial properties</strong> are:</p>
<blockquote>
<div><ul class="simple">
<li>The <strong>mass</strong> <span class="math">\(m\)</span> (tons)</li>
<li>The position of the <strong>center of gravity</strong> in the mesh&#8217;s reference frame <span class="math">\(\vec{OG}\)</span></li>
<li>The (3x3) symmetric 3D rotational <strong>inertia matrix</strong> <span class="math">\(\mathbf{I}_O\)</span></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">The inertia matrix must be expressed with respect to a <em>reduction point</em>. Internally, inertia calculations are
done in the mesh&#8217;s reference frame (where vertices coordinates are expressed) so <strong>the default inertia matrix is
expressed at the mesh&#8217;s origin</strong>. Please see the <code class="docutils literal"><span class="pre">--reduction-point</span></code> and <code class="docutils literal"><span class="pre">--at-cog</span></code> options to specify an
other reduction point.</p>
</li>
<li><p class="first">Note also that the default unit for mass in Meshmagick is the ton ! This is of practical use in offshore
applications.</p>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">Pay attention that the inertia products Ixy, Ixz and Iyz have the real significance and they should be used with
a minus sign when put in a 3D rotational inertia matrix as in <span class="math">\(\mathbf{I}_O = \begin{bmatrix} I_{xx} &amp;
-I_{xy} &amp; -I_{xz} \\ -I_{xy} &amp; I_{yy} &amp; -I_{yz} \\ -I_{xy} &amp; -I_{yz} &amp; I_{zz} \end{bmatrix}\)</span>.</p>
</li>
<li><p class="first">Coefficients are given by:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(I_{xx} = \iint_{S_w}(y^2+z^2)dS\)</span></li>
<li><span class="math">\(I_{xy} = \iint_{S_w}xydS\)</span></li>
<li><span class="math">\(I_{xz} = \iint_{S_w}xzdS\)</span></li>
<li><span class="math">\(I_{yy} = \iint_{S_w}(x^2+z^2)dS\)</span></li>
<li><span class="math">\(I_{yz} = \iint_{S_w}yzdS\)</span></li>
<li><span class="math">\(I_{zz} = \iint_{S_w}(x^2+y^2)dS\)</span></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="defining-the-medium-density">
<h3><a class="toc-backref" href="#content">Defining the medium density</a><a class="headerlink" href="#defining-the-medium-density" title="Permalink to this headline">¶</a></h3>
<p>The medium density, for both assumptions on mass distribution in the mesh, is done by using the <code class="docutils literal"><span class="pre">--rho-medium</span></code>
option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp --rho-medium 1023
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Density must be given in kg/m**3 unit.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the above command line, we specified a meshfile as an option although we have no mesh processing at all, the
aim being to get the list of available medium. This is a limitation of the <code class="docutils literal"><span class="pre">argparse</span></code> Python module that is
used in Meshmagick to parse command line options and arguments. This module does not allow to define optional
arguments that overhelms the mandatoriness of the positional arguments. Except for the <code class="docutils literal"><span class="pre">--help</span></code> command line
option, you always have to specify a mesh file while calling Meshmagick.</p>
</div>
<p>It is also possible to use some default medium density keywords. These keywords can be retrieved using the
<code class="docutils literal"><span class="pre">--list-medium</span></code> option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp --list-medium
</pre></div>
</div>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/SEAREV.vtp successfully loaded

+----------------------+----------------------+
|NAME                  |     DENSITY (KG/M**3)|
+----------------------+----------------------+
|STEEL                 |              7850.000|
+----------------------+----------------------+
|NITROGEN_-195DEGC     |               810.000|
+----------------------+----------------------+
|LEAD                  |             11350.000|
+----------------------+----------------------+
|ALUMINUM              |              2700.000|
+----------------------+----------------------+
|TITANIUM              |              4500.000|
+----------------------+----------------------+
|PROPANE               |                 2.010|
+----------------------+----------------------+
|REINFORCED_CONCRETE   |              2400.000|
+----------------------+----------------------+
|POLYSTYRENE           |              1050.000|
+----------------------+----------------------+
|GASOLINE              |               750.000|
+----------------------+----------------------+
|FRESH_WATER           |              1000.000|
+----------------------+----------------------+
|CONCRETE              |              2300.000|
+----------------------+----------------------+
|SAND                  |              1600.000|
+----------------------+----------------------+
|AIR_20DEGC            |                 1.204|
+----------------------+----------------------+
|HYDROGEN_-252DEGC     |                70.000|
+----------------------+----------------------+
|ETHANOL               |               789.000|
+----------------------+----------------------+
|BUTANE                |                 2.700|
+----------------------+----------------------+
|SALT_WATER            |              1025.000|
+----------------------+----------------------+
|DIESEL_FUEL           |               850.000|
+----------------------+----------------------+


=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
<p>An other solution is to look at the <code class="docutils literal"><span class="pre">--help</span></code> output.</p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Faire que argparse émette un warning si on a des options non reconnues.</li>
<li>Ajouter la possibilité d&#8217;exprimer les matrices résultat en un point de réduction particulier. Cette option
qu&#8217;on nomera &#8211;reduction-point (-rp) sera utilisee a la fois par les inerties et par la matrice raideur</li>
<li>On mettra aussi en place une option &#8211;at-cog pour que le poitn de reduction soit specifie au cetre de gravite</li>
</ul>
</div>
</div>
<div class="section" id="guessing-the-mesh-is-filled-with-homogeneous-medium">
<h3><a class="toc-backref" href="#content">Guessing the mesh is filled with homogeneous medium</a><a class="headerlink" href="#guessing-the-mesh-is-filled-with-homogeneous-medium" title="Permalink to this headline">¶</a></h3>
<p>This is achieved by using the <code class="docutils literal"><span class="pre">-pi</span> <span class="pre">(--plain-inertia)</span></code> option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -pi --rho-medium 800
</pre></div>
</div>
<p>that gives:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/SEAREV.vtp successfully loaded

Inertial parameters for a uniform distribution of a medium of density 800.0 kg/m**3 in the mesh:

	Mass = 2117.400 tons
	COG (m):
		xg = -0.207
		yg = -0.000
		zg = 0.547
	Inertia matrix (SI):
		1.764E+08	-1.455E-09	1.986E+06
		-1.455E-09	3.110E+07	-0.000E+00
		1.986E+06	-0.000E+00	1.723E+08
	Expressed at point : 		0.000E+00	0.000E+00	0.000E+00

=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the medium&#8217;s density is not specified, the <code class="docutils literal"><span class="pre">-pi</span></code> option guesses that the medium is salt water and then takes a
default density of 1023 kg/m**3.</p>
</div>
</div>
<div class="section" id="guessing-the-mesh-is-a-shell">
<h3><a class="toc-backref" href="#content">Guessing the mesh is a shell</a><a class="headerlink" href="#guessing-the-mesh-is-a-shell" title="Permalink to this headline">¶</a></h3>
<p>This is achieved by using the <code class="docutils literal"><span class="pre">-si</span> <span class="pre">(--shell-inertia)</span></code> option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -si --rho-medium <span class="m">5850</span> --thickness 0.02
</pre></div>
</div>
<p>that gives:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/SEAREV.vtp successfully loaded

Inertial parameters for a shell distribution of a medium of density 5850.0 kg/m**3 and a thickness of 0.020 m over the mesh:

	Mass = 140.997 tons
	COG (m):
		xg = -0.002
		yg = 0.000
		zg = 0.006
	Inertia matrix (SI):
		1.578E+07	-1.375E+01	2.205E+05
		-1.375E+01	3.799E+06	-6.452E+00
		2.205E+05	-6.452E+00	1.536E+07
	Expressed at point : 		0.000E+00	0.000E+00	0.000E+00

=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>If the <code class="docutils literal"><span class="pre">--rho-medium</span></code> option is not specified, the medium density is by default considered that of steel (5850
kg/m**3)</li>
<li>If the <code class="docutils literal"><span class="pre">--thickness</span></code> option is not specified, the thickness of the shell is by default considered being 0.02
meters.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="performing-hydrostatics-calculations-on-the-mesh">
<h2><a class="toc-backref" href="#content">Performing hydrostatics calculations on the mesh</a><a class="headerlink" href="#performing-hydrostatics-calculations-on-the-mesh" title="Permalink to this headline">¶</a></h2>
<p>Meshmagick allows to perform some hydrostatics computations on meshes. You can get the current hydrostatics
properties of the mesh such as the hydrostatic stiffness matrix, metacentric heights, floating plane area...</p>
<p>It is also able to compute the hydrostatic equilibrium of the mesh with respect to a given floater mass and/or a
given position of the center of gravity as well as additional external forces.</p>
<div class="section" id="expression-of-the-hydrostatic-data">
<h3><a class="toc-backref" href="#content">Expression of the hydrostatic data</a><a class="headerlink" href="#expression-of-the-hydrostatic-data" title="Permalink to this headline">¶</a></h3>
<p>The hydrostatic stiffness matrix coefficients only depend on the geometry of the flotation plane that is the polygon
(s) generated by the intersection of the body with the horizontal plane Oxy. The matrix writes:</p>
<div class="math">
\[\begin{split}K_{hs} = \begin{bmatrix}
            0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
            0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
            0 &amp; 0 &amp; K_{33} &amp; K_{34} &amp; K_{35} &amp; 0 \\
            0 &amp; 0 &amp; K_{43} &amp; K_{44} &amp; K_{45} &amp; 0 \\
            0 &amp; 0 &amp; K_{53} &amp; K_{54} &amp; K_{55} &amp; 0 \\
            0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
         \end{bmatrix}\end{split}\]</div>
<p>This matrix is symmetric so that we have <span class="math">\(K_{43}=K_{34}\)</span>, <span class="math">\(K_{53}=K_{35}\)</span> and <span class="math">\(K_{54}=K_{45}\)</span> and
we will only present 6 coefficients in the hydrostatic reports.</p>
<p>The expression of the hydrostatic coefficients is:</p>
<div class="math">
\begin{eqnarray}
    K_{33} &amp;=&amp; \rho g S_f\\
    K_{34} &amp;=&amp; \rho g \iint_{S_f} y dS\\
    K_{35} &amp;=&amp; -\rho g \iint_{S_f} x dS\\
    K_{45} &amp;=&amp; -\rho g \iint_{S_f} xy dS\\
    R_t &amp;=&amp; \frac{1}{\nabla} \iint_{S_f} y^2 dS\\
    R_l &amp;=&amp; \frac{1}{\nabla} \iint_{S_f} x^2 dS\\
    a &amp;=&amp; z_g - z_b \\
    GM_t &amp;=&amp; R_t - a\\
    GM_l &amp;=&amp; R_l - a\\
    K_{44} &amp;=&amp; \rho g \nabla GM_t\\
    K_{55} &amp;=&amp; \rho g \nabla GM_l\\
    x_f &amp;=&amp; -\frac{K_{35}}{K_{33}}\\
    x_f &amp;=&amp; \frac{K_{34}}{K_{33}}
\end{eqnarray}</div><p>where <span class="math">\(\nabla\)</span> is the volume displacement of the body, <span class="math">\(R_t\)</span> and <span class="math">\(R_l\)</span> are respectively the
transversal and longitudinal metacentric radius, <span class="math">\(GM_t\)</span> and <span class="math">\(GM_l\)</span> are respectively the
transversal and longitudinal metacentric heights, <span class="math">\(x_f\)</span> and <span class="math">\(y_f\)</span> are the horizontal position of the
center of the flotation plane.</p>
</div>
<div class="section" id="getting-hydrostatics-properties-of-the-mesh">
<h3><a class="toc-backref" href="#content">Getting hydrostatics properties of the mesh</a><a class="headerlink" href="#getting-hydrostatics-properties-of-the-mesh" title="Permalink to this headline">¶</a></h3>
<p>To get an hydrostatic report on the current configuration of the mesh, you may use the <abbr title="--hydrostatics">-hs</abbr>
option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -hs
</pre></div>
</div>
<p>that gives:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/SEAREV.vtp successfully loaded

Generating hydrostatic data for a zcog of 0.000 meters.


	GRAVITY ACCELERATION (M/S**2)-----------&gt;   9.81
	DENSITY OF WATER (KG/M**3)--------------&gt;   1023.0

	WATERPLANE AREA (M**2)------------------&gt;   299.8
	WATERPLANE CENTER (M)-------------------&gt;  -0.001    -0.000    
	WET AREA (M**2)-------------------------&gt;   549.6
	DISPLACEMENT VOLUME (M**3)--------------&gt;   1176.831
	DISPLACEMENT MASS (TONS)----------------&gt;   1203.898
	BUOYANCY CENTER (M)---------------------&gt;  -0.000     0.000    -2.121    
	CENTER OF GRAVITY (M)-------------------&gt;   0.000     0.000     0.000    

	DRAUGHT (M)-----------------------------&gt;   5.000
	LENGTH OVERALL SUBMERGED (M)------------&gt;   10.00
	BREADTH OVERALL SUBMERGED (M)-----------&gt;   30.00
	LENGTH AT WATERLINE LWL (M)-------------&gt;   9.99
	FORWARD PERPENDICULAR (M)---------------&gt;   5.00

	TRANSVERSAL METACENTRIC RADIUS (M)------&gt;   19.107
	TRANSVERSAL METACENTRIC HEIGHT GMT (M)--&gt;   16.986
	LONGITUDINAL METACENTRIC RADIUS (M)-----&gt;   2.120
	LONGITUDINAL METACENTRIC HEIGHT GML (M)-&gt;  -0.001

	HYDROSTATIC STIFFNESS COEFFICIENTS:
	K33 (N/M)-------------------------------&gt;   3.0088E+06
	K34 (N)---------------------------------&gt;   0.0000E+00
	K35 (N)---------------------------------&gt;   1.7289E+03
	K44 (N.M)-------------------------------&gt;   2.0061E+08
	K45 (N.M)-------------------------------&gt;   0.0000E+00
	K55 (N.M)-------------------------------&gt;  -6.1076E+03

	INERTIAS:
	IXX-------------------------------------&gt;   9.239E+07
	IXY-------------------------------------&gt;   0.000E+00
	IXZ-------------------------------------&gt;   9.572E+01
	IYY-------------------------------------&gt;   9.617E+06
	IYZ-------------------------------------&gt;   9.304E-10
	IZZ-------------------------------------&gt;   9.781E+07

	RESIDUALS:
	ABSOLUTE--------------------------------&gt;   1.863E-09 0.000E+00 6.889E+02
	RELATIVE--------------------------------&gt;   1.577E-16 0.000E+00 5.837E-06
	RELATIVE TOLERANCE----------------------&gt;   1.0E-02


=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
<p>When using this option alone (without giving a mass or center of gravity), the system considers that the current
displacement correspond to the mass of the body. However, the vertical position of the center of gravity used in the
computation of the K44 and K55 stiffness coefficients is considered to be 0 as specified at the beginning of the
report. You may also want to specify this vertical position by using the &#8211;zcog option, by eg.:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -hs --zcog 2
</pre></div>
</div>
<p>that gives the following report:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/SEAREV.vtp successfully loaded

Generating hydrostatic data for a zcog of 2.000 meters.


	GRAVITY ACCELERATION (M/S**2)-----------&gt;   9.81
	DENSITY OF WATER (KG/M**3)--------------&gt;   1023.0

	WATERPLANE AREA (M**2)------------------&gt;   299.8
	WATERPLANE CENTER (M)-------------------&gt;  -0.001    -0.000    
	WET AREA (M**2)-------------------------&gt;   549.6
	DISPLACEMENT VOLUME (M**3)--------------&gt;   1176.831
	DISPLACEMENT MASS (TONS)----------------&gt;   1203.898
	BUOYANCY CENTER (M)---------------------&gt;  -0.000     0.000    -2.121    
	CENTER OF GRAVITY (M)-------------------&gt;   0.000     0.000     2.000    

	DRAUGHT (M)-----------------------------&gt;   5.000
	LENGTH OVERALL SUBMERGED (M)------------&gt;   10.00
	BREADTH OVERALL SUBMERGED (M)-----------&gt;   30.00
	LENGTH AT WATERLINE LWL (M)-------------&gt;   9.99
	FORWARD PERPENDICULAR (M)---------------&gt;   5.00

	TRANSVERSAL METACENTRIC RADIUS (M)------&gt;   19.107
	TRANSVERSAL METACENTRIC HEIGHT GMT (M)--&gt;   14.986
	LONGITUDINAL METACENTRIC RADIUS (M)-----&gt;   2.120
	LONGITUDINAL METACENTRIC HEIGHT GML (M)-&gt;  -2.001

	HYDROSTATIC STIFFNESS COEFFICIENTS:
	K33 (N/M)-------------------------------&gt;   3.0088E+06
	K34 (N)---------------------------------&gt;   0.0000E+00
	K35 (N)---------------------------------&gt;   1.7289E+03
	K44 (N.M)-------------------------------&gt;   1.7699E+08
	K45 (N.M)-------------------------------&gt;   0.0000E+00
	K55 (N.M)-------------------------------&gt;  -2.3627E+07

	INERTIAS:
	IXX-------------------------------------&gt;   9.239E+07
	IXY-------------------------------------&gt;   0.000E+00
	IXZ-------------------------------------&gt;   9.572E+01
	IYY-------------------------------------&gt;   9.617E+06
	IYZ-------------------------------------&gt;   9.304E-10
	IZZ-------------------------------------&gt;   9.781E+07

	RESIDUALS:
	ABSOLUTE--------------------------------&gt;   1.863E-09 0.000E+00 6.889E+02
	RELATIVE--------------------------------&gt;   1.577E-16 0.000E+00 5.837E-06
	RELATIVE TOLERANCE----------------------&gt;   1.0E-02


=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
<p>In our case, taking a center of gravity so high results in an unstable configuration as you can see in the report, as
the longitudinal metacentric height (GML) is negative.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">Among the results, you will find the inertia coefficients of the immersed part of the body. The assumptions done
here are that the body is filled with water. Pay attention that the inertia products Ixy, Ixz and Iyz have the
real significance and they should be used with a minus sign when put in a 3D rotational inertia matrix as in
<span class="math">\(\mathbf{I}_O = \begin{bmatrix} I_{xx} &amp; -I_{xy} &amp; -I_{xz} \\ -I_{xy} &amp; I_{yy} &amp; -I_{yz} \\ -I_{xy} &amp;
-I_{yz} &amp; I_{zz} \end{bmatrix}\)</span>.</p>
</li>
<li><p class="first">Coefficients are given by:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(I_{xx} = \iint_{S_w}(y^2+z^2)dS\)</span></li>
<li><span class="math">\(I_{xy} = \iint_{S_w}xydS\)</span></li>
<li><span class="math">\(I_{xz} = \iint_{S_w}xzdS\)</span></li>
<li><span class="math">\(I_{yy} = \iint_{S_w}(x^2+z^2)dS\)</span></li>
<li><span class="math">\(I_{yz} = \iint_{S_w}yzdS\)</span></li>
<li><span class="math">\(I_{zz} = \iint_{S_w}(x^2+y^2)dS\)</span></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can easily change the default density of water as well as gravity by using the <code class="docutils literal"><span class="pre">--rho-water</span></code> and
<code class="docutils literal"><span class="pre">--grav</span></code> options.</p>
</div>
</div>
<div class="section" id="displaying-the-mesh-with-hydrostatic-results">
<h3><a class="toc-backref" href="#content">Displaying the mesh with hydrostatic results</a><a class="headerlink" href="#displaying-the-mesh-with-hydrostatic-results" title="Permalink to this headline">¶</a></h3>
<p>As usual, you can combine the command line options with the <code class="docutils literal"><span class="pre">--show</span></code> option to display the mesh in the meshmagick
viewer. In hydrostatics mode, it will also show forces applying on the body:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -hs --show
</pre></div>
</div>
<p>will show the following:</p>
<img alt="../_images/show_hydrostatics.png" src="../_images/show_hydrostatics.png" />
<p>In the viewer, we have pressed the <code class="docutils literal"><span class="pre">w</span></code> key to get a wireframe representation and see the application points. We can
see that the buoyancy center and the gravity center of the current configuration have nearly the same horizontal
position.</p>
</div>
<div class="section" id="getting-the-mesh-vertical-position-that-complies-with-a-given-mass-displacement">
<h3><a class="toc-backref" href="#content">Getting the mesh vertical position that complies with a given mass displacement</a><a class="headerlink" href="#getting-the-mesh-vertical-position-that-complies-with-a-given-mass-displacement" title="Permalink to this headline">¶</a></h3>
<p>In that mode, the mesh is displaced so that its mas displacement becomes equal to a specified mass. This is achieved
by:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -hs --disp 1500
</pre></div>
</div>
<p>which gives:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/SEAREV.vtp successfully loaded

Setting mesh displacement to 1500.000 tons

Complying with a displacement of 1500.000 tons
----------------------------------------------
	-&gt; Convergence obtained after 10 iterations


	GRAVITY ACCELERATION (M/S**2)-----------&gt;   9.81
	DENSITY OF WATER (KG/M**3)--------------&gt;   1023.0

	WATERPLANE AREA (M**2)------------------&gt;   294.2
	WATERPLANE CENTER (M)-------------------&gt;  -0.002    -0.000    
	WET AREA (M**2)-------------------------&gt;   627.5
	DISPLACEMENT VOLUME (M**3)--------------&gt;   1466.249
	DISPLACEMENT MASS (TONS)----------------&gt;   1499.972
	BUOYANCY CENTER (M)---------------------&gt;  -0.000     0.000    -2.578    
	CENTER OF GRAVITY (M)-------------------&gt;   0.000     0.000    -0.971    

	DRAUGHT (M)-----------------------------&gt;   5.971
	LENGTH OVERALL SUBMERGED (M)------------&gt;   10.00
	BREADTH OVERALL SUBMERGED (M)-----------&gt;   30.00
	LENGTH AT WATERLINE LWL (M)-------------&gt;   9.81
	FORWARD PERPENDICULAR (M)---------------&gt;   4.90

	TRANSVERSAL METACENTRIC RADIUS (M)------&gt;   15.050
	TRANSVERSAL METACENTRIC HEIGHT GMT (M)--&gt;   13.443
	LONGITUDINAL METACENTRIC RADIUS (M)-----&gt;   1.608
	LONGITUDINAL METACENTRIC HEIGHT GML (M)-&gt;   0.002

	HYDROSTATIC STIFFNESS COEFFICIENTS:
	K33 (N/M)-------------------------------&gt;   2.9527E+06
	K34 (N)---------------------------------&gt;   0.0000E+00
	K35 (N)---------------------------------&gt;   6.4136E+03
	K44 (N.M)-------------------------------&gt;   1.9781E+08
	K45 (N.M)-------------------------------&gt;   0.0000E+00
	K55 (N.M)-------------------------------&gt;   2.4450E+04

	INERTIAS:
	IXX-------------------------------------&gt;   1.162E+08
	IXY-------------------------------------&gt;   4.072E-10
	IXZ-------------------------------------&gt;  -1.132E+02
	IYY-------------------------------------&gt;   1.369E+07
	IYZ-------------------------------------&gt;   2.942E-09
	IZZ-------------------------------------&gt;   1.224E+08

	RESIDUALS:
	ABSOLUTE--------------------------------&gt;  -2.716E+02 1.398E-08 1.767E+03
	RELATIVE--------------------------------&gt;  -1.846E-05 3.166E-17 1.225E-05
	RELATIVE TOLERANCE----------------------&gt;   1.0E-02


=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
<p>This mode is active as long as you don&#8217;t use the <code class="docutils literal"><span class="pre">--cog</span></code> option that trig the 3D equilibrium searching algorithm
that is presented in the following.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The mass has to be given <strong>in tons</strong> as it is more representative of the order of magnitude of usual masses in
offshore.</p>
</div>
</div>
<div class="section" id="d-hydrostatic-equilibrium">
<h3><a class="toc-backref" href="#content">3D hydrostatic equilibrium</a><a class="headerlink" href="#d-hydrostatic-equilibrium" title="Permalink to this headline">¶</a></h3>
<p>This mode is active as long as you use the <code class="docutils literal"><span class="pre">--cog</span></code> option such that:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -hs --cog <span class="m">0</span> <span class="m">4</span> -2 --show
</pre></div>
</div>
<p>That command outputs the following report:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>../meshmagick/meshmagick.py:1199: UserWarning: 
WARNING !! : Keep in mind that the mesh may have a new orientation in the Oxy plane so the hydrostatic
        stiffness matrix may be impractical as not expressed in a convenient axis system. Use the result
        with caution and have a look at the mesh by using the --show option.
        
        This should be fixed in a future release.
  warn(msg)

=============================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
=============================================
../meshmagick/tests/data/SEAREV.vtp successfully loaded

                
Setting mesh position so that we are at the current displacement of 1203.898 tons and in a stable
                configuration with a gravity center located at [0.000, 4.000, -2.000] meters.

Computing equilibrium from initial condition.
----------------------------------------------
Stable equilibrium reached after 6 iterations and 0 random restart


	GRAVITY ACCELERATION (M/S**2)-----------&gt;   9.81
	DENSITY OF WATER (KG/M**3)--------------&gt;   1023.0

	WATERPLANE AREA (M**2)------------------&gt;   286.6
	WATERPLANE CENTER (M)-------------------&gt;  -0.036     0.105    
	WET AREA (M**2)-------------------------&gt;   549.1
	DISPLACEMENT VOLUME (M**3)--------------&gt;   1177.038
	DISPLACEMENT MASS (TONS)----------------&gt;   1204.110
	BUOYANCY CENTER (M)---------------------&gt;  -0.001    -0.037    -2.484    
	CENTER OF GRAVITY (M)-------------------&gt;   0.000     0.000    -2.784    

	DRAUGHT (M)-----------------------------&gt;   8.006
	LENGTH OVERALL SUBMERGED (M)------------&gt;   10.00
	BREADTH OVERALL SUBMERGED (M)-----------&gt;   31.14
	LENGTH AT WATERLINE LWL (M)-------------&gt;   10.00
	FORWARD PERPENDICULAR (M)---------------&gt;   5.00

	TRANSVERSAL METACENTRIC RADIUS (M)------&gt;   18.027
	TRANSVERSAL METACENTRIC HEIGHT GMT (M)--&gt;   18.327
	LONGITUDINAL METACENTRIC RADIUS (M)-----&gt;   1.794
	LONGITUDINAL METACENTRIC HEIGHT GML (M)-&gt;   2.094

	HYDROSTATIC STIFFNESS COEFFICIENTS:
	K33 (N/M)-------------------------------&gt;   2.8759E+06
	K34 (N)---------------------------------&gt;   3.0168E+05
	K35 (N)---------------------------------&gt;   1.0349E+05
	K44 (N.M)-------------------------------&gt;   2.1649E+08
	K45 (N.M)-------------------------------&gt;   1.3589E+06
	K55 (N.M)-------------------------------&gt;   2.4733E+07

	INERTIAS:
	IXX-------------------------------------&gt;   7.609E+07
	IXY-------------------------------------&gt;  -7.944E+04
	IXZ-------------------------------------&gt;  -9.932E+03
	IYY-------------------------------------&gt;   1.118E+07
	IYZ-------------------------------------&gt;  -6.477E+06
	IZZ-------------------------------------&gt;   7.998E+07

	RESIDUALS:
	ABSOLUTE--------------------------------&gt;   2.072E+03-4.354E+05 9.319E+03
	RELATIVE--------------------------------&gt;   1.755E-04-1.202E-03 7.892E-05
	RELATIVE TOLERANCE----------------------&gt;   1.0E-02


=============================================================
meshmagick - version 1.0
Copyright 2014-2017, Ecole Centrale de Nantes
Maintainer : Francois Rongere &lt;Francois.Rongere@ec-nantes.fr&gt;
Good Bye!
=============================================================
</pre></div>
</div>
<p>and displays the following viewer:</p>
<img alt="../_images/3D_hydrostatics.png" src="../_images/3D_hydrostatics.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The solver in charge of the hydrostatic equilibrium computation is iterative. It uses the hydrostatic stiffness
matrix and the residual force to compute corrections in position and attitude of the floater (it solves a linear
system at each iteration). Since we use here a linearized approximation that is only valid for tiny displacements
and rotations, if the proposed correction is greater than some threshold, the correction is relaxed in magnitude.
The solver is then a Newton type solver.</p>
<p class="last">Sometimes, the solver could not converge to an equilibrium position (stable or not). This is detected by applying
a maximum of iteration number. If that number is reached without any convergence then the floater is rotated with
random angles to generate a new initial configuration for iterations (it is called here a restart). A maximum
number of restart is allowed. This method makes the solver very robust with respect to the initial configuration
given and it is possible to specify some position of the center of gravity that makes the floater capsize.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<ul class="last simple">
<li>Pay attention that when 3D hydrostatic equilibrium is performed, rotations around x and y as well as translation
along z are applied iteratively in order to minimize the residual force with respect to a relative tolerance
based on mesh principal dimensions. During iterations, you may have a drift of the orientation of the mesh around
the z axis. Although the hydrostatic stiffness coefficient are correctly computed, this unpredictable orientation
result in an impractical stiffness matrix as it is then not expressed in a convenient axis system. This should be
fixed in a later release of meshmagick. Please use the meshmagick viewer to see what is going on.</li>
<li>In order to perform 3D hydrostatic equilibrium searching possible, it is mandatory to use a watertight mesh so
that the boundary intersection polygons are closed.</li>
</ul>
</div>
</div>
<div class="section" id="adding-external-static-forces">
<h3><a class="toc-backref" href="#content">Adding external static forces</a><a class="headerlink" href="#adding-external-static-forces" title="Permalink to this headline">¶</a></h3>
<p>Beside the default gravity and buoyancy forces used in hydrostatic equilibrium, it is possible to add some external
forces to the floater. This may be by e.g. the force applied by the wind on the rotor of a floating wind turbine or
anchor forces.</p>
<p>Two modes are available: <strong>relative</strong> or <strong>absolute</strong> force. In both mode, the force application point follows
naturally the body during its position modifications. In <strong>relative</strong> mode, the direction of the force follows the
body. This is generally the case for the preceding wind turbine application example. In the absolute mode the
direction of the force remains fixed with respect to the absolute frame. This is the case of mooring forces.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that for these options to be used, you always need to specify a center of gravity position along with the
<code class="docutils literal"><span class="pre">--cog</span></code> option.</p>
</div>
<div class="section" id="absolute-forces">
<h4><a class="toc-backref" href="#content">Absolute forces</a><a class="headerlink" href="#absolute-forces" title="Permalink to this headline">¶</a></h4>
<p>This is achieved using the :<code class="docutils literal"><span class="pre">-af</span> <span class="pre">(--absolute-force)</span></code> option. By example, applying a vertical mooring load of
200 tons at one side of the SEAREV is obtained by issuing:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -hs -af <span class="m">0</span> <span class="m">15</span> -5 <span class="m">0</span> <span class="m">0</span> -2000000 --cog <span class="m">0</span> <span class="m">0</span> -2 --show
</pre></div>
</div>
<p>Note that the parameters of the options are first the 3 coordinates of the application point then the 3 components of
the force vector.</p>
<p>As the <code class="docutils literal"><span class="pre">--show</span></code> option has been used, the command displays the following viewer:</p>
<img alt="../_images/hs_absolute_force.png" src="../_images/hs_absolute_force.png" />
<p>where you can observe that the force represented in blue has the right vertical orientation and made the SEAREV roll.</p>
</div>
<div class="section" id="relative-forces">
<h4><a class="toc-backref" href="#content">Relative forces</a><a class="headerlink" href="#relative-forces" title="Permalink to this headline">¶</a></h4>
<p>This is achieved using the <code class="docutils literal"><span class="pre">-af</span> <span class="pre">(--absolute-force)</span></code> option. By example, applying a vertical mooring load of
200 tons at one side of the SEAREV is obtained by issuing:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -hs --cog <span class="m">0</span> <span class="m">0</span> -3 -rf <span class="m">0</span> <span class="m">0</span> <span class="m">5</span> <span class="m">5000000</span> <span class="m">0</span> <span class="m">0</span> --show
</pre></div>
</div>
<p>which displays the following viewer:</p>
<img alt="../_images/hs_relative_force.png" src="../_images/hs_relative_force.png" />
<p>where you can observe that the force represented in blue has followed the pitch of the body.</p>
</div>
</div>
<div class="section" id="saving-the-hydrostatic-report-in-a-text-file">
<h3><a class="toc-backref" href="#content">Saving the hydrostatic report in a text file</a><a class="headerlink" href="#saving-the-hydrostatic-report-in-a-text-file" title="Permalink to this headline">¶</a></h3>
<p>Use the <code class="docutils literal"><span class="pre">--hs-report</span></code> option followed by the name of the file:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt;$ meshmagick SEAREV.vtp -hs --hs-report report.txt
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cli_reference.html" class="btn btn-neutral float-right" title="Command Line Interface Reference Guide" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Meshmagick’s Command Line Interface" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Ecole Centrale de Nantes.
      Last updated on Jan 05, 2017.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>